2025-07-29 09:47:01,000 |     INFO | core.Core | 初始化DataSegment: 8 个进程, chunk_size=200000
2025-07-29 09:47:01,000 |     INFO | core.Core | DataProcessor初始化: chunk_size=200000, n_processes=8
2025-07-29 09:47:01,001 |     INFO | core.Core | 预测器初始化: GPU=None
2025-07-29 09:47:01,001 |     INFO | core.Core | 航班排名系统核心控制器初始化完成
2025-07-29 09:47:01,002 |     INFO | core.Core | ================================================================================
2025-07-29 09:47:01,002 |     INFO | core.Core | 开始完整流水线执行
2025-07-29 09:47:01,002 |     INFO | core.Core | ================================================================================
2025-07-29 09:47:01,002 |     INFO | core.Core | ============================================================
2025-07-29 09:47:01,003 |     INFO | core.Core | 开始数据处理阶段
2025-07-29 09:47:01,003 |     INFO | core.Core | ============================================================
2025-07-29 09:47:01,003 |     INFO | core.Core | 开始数据处理流水线
2025-07-29 09:47:01,004 |     INFO | core.Core | 所有输出文件已存在
2025-07-29 09:47:01,005 |     INFO | core.Core | 执行完整性验证...
2025-07-29 09:47:01,005 |     INFO | core.Core | 开始验证分割结果...
2025-07-29 09:47:12,936 |     INFO | core.Core | 验证结果:
2025-07-29 09:47:12,940 |     INFO | core.Core |   原始数据: 18,145,372 行, 105,539 ranker_id
2025-07-29 09:47:12,941 |     INFO | core.Core |   分割数据: 18,075,751 行, 90,728 ranker_id
2025-07-29 09:47:12,942 |     INFO | core.Core |   行数匹配: False, ranker_id匹配: False
2025-07-29 09:47:12,943 |  WARNING | core.Core | 行数差异: 69621 行
2025-07-29 09:47:12,944 |  WARNING | core.Core | ranker_id差异: 14811 个
2025-07-29 09:47:13,948 |  WARNING | core.Core | 略过 Train 数据集完整性验证
2025-07-29 09:47:13,951 |     INFO | core.Core | 开始验证分割结果...
2025-07-29 09:47:23,781 |     INFO | core.Core | 验证结果:
2025-07-29 09:47:23,783 |     INFO | core.Core |   原始数据: 6,897,776 行, 45,231 ranker_id
2025-07-29 09:47:23,784 |     INFO | core.Core |   分割数据: 6,897,776 行, 45,231 ranker_id
2025-07-29 09:47:23,785 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-29 09:47:23,993 |     INFO | core.Core | 现有分割文件验证通过
2025-07-29 09:47:23,994 |     INFO | core.Core | 验证通过，跳过处理
2025-07-29 09:47:23,996 |     INFO | core.Core | process_pipeline 耗时: 22.99s
2025-07-29 09:47:23,998 |     INFO | core.Core | ✓ 数据处理阶段完成
2025-07-29 09:47:23,999 |     INFO | core.Core | run_data_processing 耗时: 23.00s
2025-07-29 09:47:24,000 |     INFO | core.Core | ============================================================
2025-07-29 09:47:24,001 |     INFO | core.Core | 开始模型训练阶段
2025-07-29 09:47:24,002 |     INFO | core.Core | ============================================================
2025-07-29 09:47:24,003 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_0.parquet
2025-07-29 09:47:24,005 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_1.parquet
2025-07-29 09:47:24,006 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_2.parquet
2025-07-29 09:47:24,006 |     INFO | core.Core | 开始K-Fold训练所有段: [0, 1, 2]
2025-07-29 09:47:24,007 |     INFO | core.Core | 开始K-Fold训练 segment_0
2025-07-29 09:47:25,788 |     INFO | core.Core | 原始数据形状: (6089760, 52)
2025-07-29 09:47:29,812 |     INFO | core.Core | 原始ranker数量: 18560
2025-07-29 09:47:31,358 |     INFO | core.Core | 过滤后ranker数量: 18560
2025-07-29 09:47:31,360 |     INFO | core.Core | 过滤后数据形状: (6089760, 52)
2025-07-29 09:47:31,464 |    ERROR | core.Core | ✗ segment_0 训练失败: 'FlightRankingModels' object has no attribute 'gpu_status'
2025-07-29 09:47:31,649 |     INFO | core.Core | 开始K-Fold训练 segment_1
2025-07-29 09:47:32,584 |     INFO | core.Core | 原始数据形状: (10865187, 76)
2025-07-29 09:47:36,382 |     INFO | core.Core | 原始ranker数量: 66586
2025-07-29 09:47:36,978 |     INFO | core.Core | 过滤后ranker数量: 66586
2025-07-29 09:47:36,978 |     INFO | core.Core | 过滤后数据形状: (10865187, 76)
2025-07-29 09:47:37,022 |    ERROR | core.Core | ✗ segment_1 训练失败: 'FlightRankingModels' object has no attribute 'gpu_status'
2025-07-29 09:47:37,222 |     INFO | core.Core | 开始K-Fold训练 segment_2
2025-07-29 09:47:37,335 |     INFO | core.Core | 原始数据形状: (1120257, 100)
2025-07-29 09:47:37,596 |     INFO | core.Core | 原始ranker数量: 5575
2025-07-29 09:47:37,655 |     INFO | core.Core | 过滤后ranker数量: 5575
2025-07-29 09:47:37,656 |     INFO | core.Core | 过滤后数据形状: (1120257, 100)
2025-07-29 09:47:37,662 |    ERROR | core.Core | ✗ segment_2 训练失败: 'FlightRankingModels' object has no attribute 'gpu_status'
2025-07-29 09:47:37,677 |     INFO | core.Core | K-Fold训练完成: 0/3 成功
2025-07-29 09:47:37,678 |    ERROR | core.Core | ✗ 模型训练阶段失败
2025-07-29 09:47:37,678 |     INFO | core.Core | run_model_training 耗时: 13.68s
2025-07-29 09:47:37,678 |    ERROR | core.Core | 模型训练失败，终止流水线
2025-07-29 09:47:37,678 |     INFO | core.Core | run_full_pipeline 耗时: 36.68s
