2025-07-28 20:36:43,215 |     INFO | core.Core | 初始化DataSegment: 8 个进程, chunk_size=200000
2025-07-28 20:36:43,216 |     INFO | core.Core | DataProcessor初始化: chunk_size=200000, n_processes=8
2025-07-28 20:36:43,216 |     INFO | core.Core | 预测器初始化: GPU=None
2025-07-28 20:36:43,217 |     INFO | core.Core | 航班排名系统核心控制器初始化完成
2025-07-28 20:36:43,217 |     INFO | core.Core | ================================================================================
2025-07-28 20:36:43,218 |     INFO | core.Core | 开始完整流水线执行
2025-07-28 20:36:43,218 |     INFO | core.Core | ================================================================================
2025-07-28 20:36:43,228 |     INFO | core.Core | ============================================================
2025-07-28 20:36:43,229 |     INFO | core.Core | 开始数据处理阶段
2025-07-28 20:36:43,229 |     INFO | core.Core | ============================================================
2025-07-28 20:36:43,229 |     INFO | core.Core | 开始数据处理流水线
2025-07-28 20:36:43,229 |     INFO | core.Core | 开始处理 TRAIN 数据
2025-07-28 20:36:43,231 |     INFO | core.Core | 编码文件已存在，跳过: data\aeroclub-recsys-2025\encoded\train\train_encoded.parquet
2025-07-28 20:36:43,231 |     INFO | core.Core | encode_data 耗时: 0.00s
2025-07-28 20:36:43,231 |     INFO | core.Core | 开始分割 train 数据
2025-07-28 20:36:43,251 |     INFO | core.Core | 输入: 18,145,372 行, 287.2MB
2025-07-28 20:36:43,252 |     INFO | core.Core | 开始分割处理 data\aeroclub-recsys-2025\encoded\train\train_encoded.parquet
2025-07-28 20:36:43,252 |     INFO | core.Core | 开始预扫描文件进行ranker_id分类...
2025-07-28 21:00:16,214 |     INFO | core.Core | 已处理 10 批次，发现 14063 个ranker_id
2025-07-28 21:21:27,263 |     INFO | core.Core | 已处理 20 批次，发现 26207 个ranker_id
2025-07-28 21:38:58,679 |     INFO | core.Core | 已处理 30 批次，发现 36445 个ranker_id
2025-07-28 21:55:00,566 |     INFO | core.Core | 已处理 40 批次，发现 46006 个ranker_id
2025-07-28 22:10:14,732 |     INFO | core.Core | 已处理 50 批次，发现 56044 个ranker_id
2025-07-28 22:24:02,948 |     INFO | core.Core | 已处理 60 批次，发现 65723 个ranker_id
2025-07-28 22:42:09,905 |     INFO | core.Core | 已处理 70 批次，发现 78434 个ranker_id
2025-07-28 23:05:03,912 |     INFO | core.Core | 已处理 80 批次，发现 91723 个ranker_id
2025-07-28 23:26:39,589 |     INFO | core.Core | 已处理 90 批次，发现 104646 个ranker_id
2025-07-28 23:27:48,809 |     INFO | core.Core | 分类完成，总计 105539 个ranker_id:
2025-07-28 23:27:48,810 |     INFO | core.Core |   Segment 3: 7 个ranker_id
2025-07-28 23:27:48,811 |     INFO | core.Core |   Segment 2: 5652 个ranker_id
2025-07-28 23:27:48,812 |     INFO | core.Core |   Segment 1: 72255 个ranker_id
2025-07-28 23:27:48,813 |     INFO | core.Core |   Segment 0: 27625 个ranker_id
2025-07-28 23:27:48,845 |     INFO | core.Core | 创建了 18 个批次
2025-07-28 23:27:48,846 |     INFO | core.Core | 处理 segment_3 级别数据，包含 7 个ranker_id...
2025-07-28 23:28:20,425 |     INFO | core.Core | 剔除 4 个恒定值列: ['bySelf', 'nationality', 'isVip', 'pricingInfo_passengerCount']
2025-07-28 23:28:20,442 |     INFO | core.Core | 按ranker_id分组过滤: 移除 0 行（0 个组）
2025-07-28 23:28:20,545 |     INFO | core.Core | 处理后数据形状: (547, 122)
2025-07-28 23:28:20,546 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\train\train_segment_3.parquet, 共 547 行
2025-07-28 23:28:20,641 |     INFO | core.Core | segment_3 处理完成: 547 行
2025-07-28 23:28:20,644 |     INFO | core.Core | 处理 segment_2 级别数据，包含 5652 个ranker_id...
2025-07-28 23:28:56,765 |     INFO | core.Core | 剔除 26 个恒定值列: ['bySelf', 'legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-28 23:28:58,208 |     INFO | core.Core | 按ranker_id分组过滤: 移除 534 行（77 个组）
2025-07-28 23:29:06,002 |     INFO | core.Core | 处理后数据形状: (1120257, 100)
2025-07-28 23:29:06,003 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\train\train_segment_2.parquet, 共 1120257 行
2025-07-28 23:29:06,327 |     INFO | core.Core | segment_2 处理完成: 1120257 行
2025-07-28 23:29:06,329 |     INFO | core.Core | 处理 segment_1 级别数据，包含 72255 个ranker_id...
2025-07-28 23:29:38,732 |     INFO | core.Core | 剔除 50 个恒定值列: ['bySelf', 'legs0_segments2_aircraft_code', 'legs0_segments2_arrivalTo_airport_city_iata', 'legs0_segments2_arrivalTo_airport_iata', 'legs0_segments2_baggageAllowance_quantity', 'legs0_segments2_baggageAllowance_weightMeasurementType', 'legs0_segments2_cabinClass', 'legs0_segments2_departureFrom_airport_iata', 'legs0_segments2_duration', 'legs0_segments2_flightNumber', 'legs0_segments2_marketingCarrier_code', 'legs0_segments2_operatingCarrier_code', 'legs0_segments2_seatsAvailable', 'legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments2_aircraft_code', 'legs1_segments2_arrivalTo_airport_city_iata', 'legs1_segments2_arrivalTo_airport_iata', 'legs1_segments2_baggageAllowance_quantity', 'legs1_segments2_baggageAllowance_weightMeasurementType', 'legs1_segments2_cabinClass', 'legs1_segments2_departureFrom_airport_iata', 'legs1_segments2_duration', 'legs1_segments2_flightNumber', 'legs1_segments2_marketingCarrier_code', 'legs1_segments2_operatingCarrier_code', 'legs1_segments2_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-28 23:29:42,296 |     INFO | core.Core | 按ranker_id分组过滤: 移除 32833 行（5669 个组）
2025-07-28 23:29:56,267 |     INFO | core.Core | 处理后数据形状: (10865187, 76)
2025-07-28 23:29:56,268 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\train\train_segment_1.parquet, 共 10865187 行
2025-07-28 23:29:56,916 |     INFO | core.Core | segment_1 处理完成: 10865187 行
2025-07-28 23:29:56,917 |     INFO | core.Core | 处理 segment_0 级别数据，包含 27625 个ranker_id...
2025-07-28 23:30:43,387 |     INFO | core.Core | 剔除 74 个恒定值列: ['bySelf', 'legs0_segments1_aircraft_code', 'legs0_segments1_arrivalTo_airport_city_iata', 'legs0_segments1_arrivalTo_airport_iata', 'legs0_segments1_baggageAllowance_quantity', 'legs0_segments1_baggageAllowance_weightMeasurementType', 'legs0_segments1_cabinClass', 'legs0_segments1_departureFrom_airport_iata', 'legs0_segments1_duration', 'legs0_segments1_flightNumber', 'legs0_segments1_marketingCarrier_code', 'legs0_segments1_operatingCarrier_code', 'legs0_segments1_seatsAvailable', 'legs0_segments2_aircraft_code', 'legs0_segments2_arrivalTo_airport_city_iata', 'legs0_segments2_arrivalTo_airport_iata', 'legs0_segments2_baggageAllowance_quantity', 'legs0_segments2_baggageAllowance_weightMeasurementType', 'legs0_segments2_cabinClass', 'legs0_segments2_departureFrom_airport_iata', 'legs0_segments2_duration', 'legs0_segments2_flightNumber', 'legs0_segments2_marketingCarrier_code', 'legs0_segments2_operatingCarrier_code', 'legs0_segments2_seatsAvailable', 'legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments1_aircraft_code', 'legs1_segments1_arrivalTo_airport_city_iata', 'legs1_segments1_arrivalTo_airport_iata', 'legs1_segments1_baggageAllowance_quantity', 'legs1_segments1_baggageAllowance_weightMeasurementType', 'legs1_segments1_cabinClass', 'legs1_segments1_departureFrom_airport_iata', 'legs1_segments1_duration', 'legs1_segments1_flightNumber', 'legs1_segments1_marketingCarrier_code', 'legs1_segments1_operatingCarrier_code', 'legs1_segments1_seatsAvailable', 'legs1_segments2_aircraft_code', 'legs1_segments2_arrivalTo_airport_city_iata', 'legs1_segments2_arrivalTo_airport_iata', 'legs1_segments2_baggageAllowance_quantity', 'legs1_segments2_baggageAllowance_weightMeasurementType', 'legs1_segments2_cabinClass', 'legs1_segments2_departureFrom_airport_iata', 'legs1_segments2_duration', 'legs1_segments2_flightNumber', 'legs1_segments2_marketingCarrier_code', 'legs1_segments2_operatingCarrier_code', 'legs1_segments2_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-28 23:30:49,031 |     INFO | core.Core | 按ranker_id分组过滤: 移除 36254 行（9065 个组）
2025-07-28 23:31:10,954 |     INFO | core.Core | 处理后数据形状: (6089760, 52)
2025-07-28 23:31:10,956 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\train\train_segment_0.parquet, 共 6089760 行
2025-07-28 23:31:11,827 |     INFO | core.Core | segment_0 处理完成: 6089760 行
2025-07-28 23:31:11,828 |     INFO | core.Core | 完成分割 data\aeroclub-recsys-2025\encoded\train\train_encoded.parquet
2025-07-28 23:31:11,829 |     INFO | core.Core | 分割结果汇总:
2025-07-28 23:31:11,830 |     INFO | core.Core |   Segment 3: 547 行
2025-07-28 23:31:11,831 |     INFO | core.Core |   Segment 2: 1,120,257 行
2025-07-28 23:31:11,831 |     INFO | core.Core |   Segment 1: 10,865,187 行
2025-07-28 23:31:11,832 |     INFO | core.Core |   Segment 0: 6,089,760 行
2025-07-28 23:31:11,835 |     INFO | core.Core | 总计输出: 18,075,751 行
2025-07-28 23:31:11,859 |     INFO | core.Core | 分割完成，总计: 18,075,751 行，耗时: 2:54:28.627545
2025-07-28 23:31:11,860 |     INFO | core.Core |   Segment 3: 547 行
2025-07-28 23:31:11,861 |     INFO | core.Core |   Segment 2: 1,120,257 行
2025-07-28 23:31:11,863 |     INFO | core.Core |   Segment 1: 10,865,187 行
2025-07-28 23:31:11,865 |     INFO | core.Core |   Segment 0: 6,089,760 行
2025-07-28 23:31:11,866 |    ERROR | core.Core | 行数不匹配! 输入: 18145372, 分割: 18075751
2025-07-28 23:31:11,867 |     INFO | core.Core | segment_data 耗时: 10468.64s
2025-07-28 23:31:11,868 |     INFO | core.Core | process_data_type 耗时: 10468.64s
2025-07-28 23:31:11,869 |    ERROR | core.Core | train 处理失败
2025-07-28 23:31:11,870 |     INFO | core.Core | process_pipeline 耗时: 10468.64s
2025-07-28 23:31:11,871 |    ERROR | core.Core | ✗ 数据处理阶段失败
2025-07-28 23:31:11,872 |     INFO | core.Core | run_data_processing 耗时: 10468.64s
2025-07-28 23:31:11,873 |    ERROR | core.Core | 数据处理失败，终止流水线
2025-07-28 23:31:11,874 |     INFO | core.Core | run_full_pipeline 耗时: 10468.66s
