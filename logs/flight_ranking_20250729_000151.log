2025-07-29 00:01:51,817 |     INFO | core.Core | 初始化DataSegment: 8 个进程, chunk_size=200000
2025-07-29 00:01:51,818 |     INFO | core.Core | DataProcessor初始化: chunk_size=200000, n_processes=8
2025-07-29 00:01:51,819 |     INFO | core.Core | 预测器初始化: GPU=None
2025-07-29 00:01:51,819 |     INFO | core.Core | 航班排名系统核心控制器初始化完成
2025-07-29 00:01:51,819 |     INFO | core.Core | ================================================================================
2025-07-29 00:01:51,819 |     INFO | core.Core | 开始完整流水线执行
2025-07-29 00:01:51,820 |     INFO | core.Core | ================================================================================
2025-07-29 00:01:51,830 |     INFO | core.Core | ============================================================
2025-07-29 00:01:51,830 |     INFO | core.Core | 开始数据处理阶段
2025-07-29 00:01:51,830 |     INFO | core.Core | ============================================================
2025-07-29 00:01:51,830 |     INFO | core.Core | 开始数据处理流水线
2025-07-29 00:01:51,831 |     INFO | core.Core | 开始处理 TRAIN 数据
2025-07-29 00:01:51,831 |     INFO | core.Core | 编码文件已存在，跳过: data\aeroclub-recsys-2025\encoded\train\train_encoded.parquet
2025-07-29 00:01:51,832 |     INFO | core.Core | encode_data 耗时: 0.00s
2025-07-29 00:01:51,832 |     INFO | core.Core | 分割文件已存在，跳过
2025-07-29 00:01:51,833 |     INFO | core.Core | 开始验证分割结果...
2025-07-29 00:01:57,590 |     INFO | core.Core | 验证结果:
2025-07-29 00:01:57,591 |     INFO | core.Core |   原始数据: 18,145,372 行, 105,539 ranker_id
2025-07-29 00:01:57,591 |     INFO | core.Core |   分割数据: 18,075,751 行, 90,728 ranker_id
2025-07-29 00:01:57,591 |     INFO | core.Core |   行数匹配: False, ranker_id匹配: False
2025-07-29 00:01:57,592 |  WARNING | core.Core | 行数差异: 69621 行
2025-07-29 00:01:57,592 |  WARNING | core.Core | ranker_id差异: 14811 个
2025-07-29 00:01:57,806 |  WARNING | core.Core | 略过 Train 数据集完整性验证
2025-07-29 00:01:57,807 |     INFO | core.Core | segment_data 耗时: 5.97s
2025-07-29 00:01:57,808 |     INFO | core.Core | TRAIN 数据处理完成
2025-07-29 00:01:57,808 |     INFO | core.Core | process_data_type 耗时: 5.98s
2025-07-29 00:01:57,808 |     INFO | core.Core | 开始处理 TEST 数据
2025-07-29 00:01:57,809 |     INFO | core.Core | 编码文件已存在，跳过: data\aeroclub-recsys-2025\encoded\test\test_encoded.parquet
2025-07-29 00:01:57,810 |     INFO | core.Core | encode_data 耗时: 0.00s
2025-07-29 00:01:57,810 |     INFO | core.Core | 开始分割 test 数据
2025-07-29 00:01:57,813 |     INFO | core.Core | 输入: 6,897,776 行, 105.5MB
2025-07-29 00:01:57,813 |     INFO | core.Core | 开始分割处理 data\aeroclub-recsys-2025\encoded\test\test_encoded.parquet
2025-07-29 00:01:57,814 |     INFO | core.Core | 开始预扫描文件进行ranker_id分类...
2025-07-29 00:08:28,144 |     INFO | core.Core | 已处理 10 批次，发现 13495 个ranker_id
2025-07-29 00:13:32,202 |     INFO | core.Core | 已处理 20 批次，发现 26003 个ranker_id
2025-07-29 00:18:42,291 |     INFO | core.Core | 已处理 30 批次，发现 38410 个ranker_id
2025-07-29 00:21:15,727 |     INFO | core.Core | 分类完成，总计 45231 个ranker_id:
2025-07-29 00:21:15,727 |     INFO | core.Core |   Segment 2: 2014 个ranker_id
2025-07-29 00:21:15,727 |     INFO | core.Core |   Segment 1: 33115 个ranker_id
2025-07-29 00:21:15,727 |     INFO | core.Core |   Segment 0: 10102 个ranker_id
2025-07-29 00:21:15,733 |     INFO | core.Core | 创建了 7 个批次
2025-07-29 00:21:15,747 |     INFO | core.Core | Segment 3: 无数据，创建空文件
2025-07-29 00:21:15,747 |     INFO | core.Core | 处理 segment_2 级别数据，包含 2014 个ranker_id...
2025-07-29 00:21:22,923 |     INFO | core.Core | 剔除 25 个恒定值列: ['legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-29 00:21:23,583 |     INFO | core.Core | 处理后数据形状: (358948, 100)
2025-07-29 00:21:23,584 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\test\test_segment_2.parquet, 共 358948 行
2025-07-29 00:21:23,635 |     INFO | core.Core | segment_2 处理完成: 358948 行
2025-07-29 00:21:23,635 |     INFO | core.Core | 处理 segment_1 级别数据，包含 33115 个ranker_id...
2025-07-29 00:21:34,355 |     INFO | core.Core | 剔除 49 个恒定值列: ['legs0_segments2_aircraft_code', 'legs0_segments2_arrivalTo_airport_city_iata', 'legs0_segments2_arrivalTo_airport_iata', 'legs0_segments2_baggageAllowance_quantity', 'legs0_segments2_baggageAllowance_weightMeasurementType', 'legs0_segments2_cabinClass', 'legs0_segments2_departureFrom_airport_iata', 'legs0_segments2_duration', 'legs0_segments2_flightNumber', 'legs0_segments2_marketingCarrier_code', 'legs0_segments2_operatingCarrier_code', 'legs0_segments2_seatsAvailable', 'legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments2_aircraft_code', 'legs1_segments2_arrivalTo_airport_city_iata', 'legs1_segments2_arrivalTo_airport_iata', 'legs1_segments2_baggageAllowance_quantity', 'legs1_segments2_baggageAllowance_weightMeasurementType', 'legs1_segments2_cabinClass', 'legs1_segments2_departureFrom_airport_iata', 'legs1_segments2_duration', 'legs1_segments2_flightNumber', 'legs1_segments2_marketingCarrier_code', 'legs1_segments2_operatingCarrier_code', 'legs1_segments2_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-29 00:21:40,504 |     INFO | core.Core | 处理后数据形状: (4111603, 76)
2025-07-29 00:21:40,505 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\test\test_segment_1.parquet, 共 4111603 行
2025-07-29 00:21:40,648 |     INFO | core.Core | segment_1 处理完成: 4111603 行
2025-07-29 00:21:40,649 |     INFO | core.Core | 处理 segment_0 级别数据，包含 10102 个ranker_id...
2025-07-29 00:21:49,243 |     INFO | core.Core | 剔除 73 个恒定值列: ['legs0_segments1_aircraft_code', 'legs0_segments1_arrivalTo_airport_city_iata', 'legs0_segments1_arrivalTo_airport_iata', 'legs0_segments1_baggageAllowance_quantity', 'legs0_segments1_baggageAllowance_weightMeasurementType', 'legs0_segments1_cabinClass', 'legs0_segments1_departureFrom_airport_iata', 'legs0_segments1_duration', 'legs0_segments1_flightNumber', 'legs0_segments1_marketingCarrier_code', 'legs0_segments1_operatingCarrier_code', 'legs0_segments1_seatsAvailable', 'legs0_segments2_aircraft_code', 'legs0_segments2_arrivalTo_airport_city_iata', 'legs0_segments2_arrivalTo_airport_iata', 'legs0_segments2_baggageAllowance_quantity', 'legs0_segments2_baggageAllowance_weightMeasurementType', 'legs0_segments2_cabinClass', 'legs0_segments2_departureFrom_airport_iata', 'legs0_segments2_duration', 'legs0_segments2_flightNumber', 'legs0_segments2_marketingCarrier_code', 'legs0_segments2_operatingCarrier_code', 'legs0_segments2_seatsAvailable', 'legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments1_aircraft_code', 'legs1_segments1_arrivalTo_airport_city_iata', 'legs1_segments1_arrivalTo_airport_iata', 'legs1_segments1_baggageAllowance_quantity', 'legs1_segments1_baggageAllowance_weightMeasurementType', 'legs1_segments1_cabinClass', 'legs1_segments1_departureFrom_airport_iata', 'legs1_segments1_duration', 'legs1_segments1_flightNumber', 'legs1_segments1_marketingCarrier_code', 'legs1_segments1_operatingCarrier_code', 'legs1_segments1_seatsAvailable', 'legs1_segments2_aircraft_code', 'legs1_segments2_arrivalTo_airport_city_iata', 'legs1_segments2_arrivalTo_airport_iata', 'legs1_segments2_baggageAllowance_quantity', 'legs1_segments2_baggageAllowance_weightMeasurementType', 'legs1_segments2_cabinClass', 'legs1_segments2_departureFrom_airport_iata', 'legs1_segments2_duration', 'legs1_segments2_flightNumber', 'legs1_segments2_marketingCarrier_code', 'legs1_segments2_operatingCarrier_code', 'legs1_segments2_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-29 00:21:51,778 |     INFO | core.Core | 处理后数据形状: (2427225, 52)
2025-07-29 00:21:51,778 |     INFO | core.Core | 分割合并完成: data\aeroclub-recsys-2025\segmented\test\test_segment_0.parquet, 共 2427225 行
2025-07-29 00:21:51,868 |     INFO | core.Core | segment_0 处理完成: 2427225 行
2025-07-29 00:21:51,868 |     INFO | core.Core | 完成分割 data\aeroclub-recsys-2025\encoded\test\test_encoded.parquet
2025-07-29 00:21:51,868 |     INFO | core.Core | 分割结果汇总:
2025-07-29 00:21:51,868 |     INFO | core.Core |   Segment 2: 358,948 行
2025-07-29 00:21:51,868 |     INFO | core.Core |   Segment 1: 4,111,603 行
2025-07-29 00:21:51,869 |     INFO | core.Core |   Segment 0: 2,427,225 行
2025-07-29 00:21:51,869 |     INFO | core.Core | 总计输出: 6,897,776 行
2025-07-29 00:21:51,874 |     INFO | core.Core | 分割完成，总计: 6,897,776 行，耗时: 0:19:54.062671
2025-07-29 00:21:51,874 |     INFO | core.Core |   Segment 2: 358,948 行
2025-07-29 00:21:51,874 |     INFO | core.Core |   Segment 1: 4,111,603 行
2025-07-29 00:21:51,874 |     INFO | core.Core |   Segment 0: 2,427,225 行
2025-07-29 00:21:51,874 |     INFO | core.Core | 开始验证分割结果...
2025-07-29 00:21:54,143 |     INFO | core.Core | 验证结果:
2025-07-29 00:21:54,143 |     INFO | core.Core |   原始数据: 6,897,776 行, 45,231 ranker_id
2025-07-29 00:21:54,143 |     INFO | core.Core |   分割数据: 6,897,776 行, 45,231 ranker_id
2025-07-29 00:21:54,144 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-29 00:21:54,190 |     INFO | core.Core | segment_data 耗时: 1196.38s
2025-07-29 00:21:54,190 |     INFO | core.Core | TEST 数据处理完成
2025-07-29 00:21:54,190 |     INFO | core.Core | process_data_type 耗时: 1196.38s
2025-07-29 00:21:54,190 |     INFO | core.Core | ==================================================
2025-07-29 00:21:54,190 |     INFO | core.Core | 数据处理流水线成功完成
2025-07-29 00:21:54,192 |     INFO | core.Core | ==================================================
2025-07-29 00:21:54,192 |     INFO | core.Core | TRAIN 数据统计:
2025-07-29 00:21:54,195 |     INFO | core.Core |   编码文件: 18,145,372 行, 287.2MB
2025-07-29 00:21:54,197 |     INFO | core.Core |   Segment 0: 6,089,760 行, 65.2MB
2025-07-29 00:21:54,199 |     INFO | core.Core |   Segment 1: 10,865,187 行, 183.3MB
2025-07-29 00:21:54,201 |     INFO | core.Core |   Segment 2: 1,120,257 行, 34.3MB
2025-07-29 00:21:54,202 |     INFO | core.Core |   Segment 3: 547 行, 0.1MB
2025-07-29 00:21:54,202 |     INFO | core.Core |   分割总计: 18,075,751 行, 282.9MB
2025-07-29 00:21:54,202 |     INFO | core.Core | TEST 数据统计:
2025-07-29 00:21:54,205 |     INFO | core.Core |   编码文件: 6,897,776 行, 105.5MB
2025-07-29 00:21:54,206 |     INFO | core.Core |   Segment 0: 2,427,225 行, 22.4MB
2025-07-29 00:21:54,208 |     INFO | core.Core |   Segment 1: 4,111,603 行, 72.1MB
2025-07-29 00:21:54,209 |     INFO | core.Core |   Segment 2: 358,948 行, 11.1MB
2025-07-29 00:21:54,209 |     INFO | core.Core |   分割总计: 6,897,776 行, 105.5MB
2025-07-29 00:21:54,209 |     INFO | core.Core | 总耗时: 0:20:02.359450
2025-07-29 00:21:54,209 |     INFO | core.Core | process_pipeline 耗时: 1202.38s
2025-07-29 00:21:54,210 |     INFO | core.Core | ✓ 数据处理阶段完成
2025-07-29 00:21:54,210 |     INFO | core.Core | run_data_processing 耗时: 1202.38s
2025-07-29 00:21:54,210 |     INFO | core.Core | ============================================================
2025-07-29 00:21:54,210 |     INFO | core.Core | 开始模型训练阶段
2025-07-29 00:21:54,210 |     INFO | core.Core | ============================================================
2025-07-29 00:21:54,210 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_0.parquet
2025-07-29 00:21:54,210 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_1.parquet
2025-07-29 00:21:54,210 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_2.parquet
2025-07-29 00:21:54,210 |     INFO | core.Core | 开始K-Fold训练所有段: [0, 1, 2]
2025-07-29 00:21:54,210 |     INFO | core.Core | 开始K-Fold训练 segment_0
2025-07-29 00:21:54,212 |    ERROR | core.Core | ✗ segment_0 训练失败: 训练文件不存在: d:\kaggle\filght\data\aeroclub-recsys-2025\segmented\segmented\train\train_segment_0.parquet
2025-07-29 00:21:54,212 |     INFO | core.Core | 开始K-Fold训练 segment_1
2025-07-29 00:21:54,212 |    ERROR | core.Core | ✗ segment_1 训练失败: 训练文件不存在: d:\kaggle\filght\data\aeroclub-recsys-2025\segmented\segmented\train\train_segment_1.parquet
2025-07-29 00:21:54,212 |     INFO | core.Core | 开始K-Fold训练 segment_2
2025-07-29 00:21:54,212 |    ERROR | core.Core | ✗ segment_2 训练失败: 训练文件不存在: d:\kaggle\filght\data\aeroclub-recsys-2025\segmented\segmented\train\train_segment_2.parquet
2025-07-29 00:21:54,212 |     INFO | core.Core | K-Fold训练完成: 0/3 成功
2025-07-29 00:21:54,212 |    ERROR | core.Core | ✗ 模型训练阶段失败
2025-07-29 00:21:54,213 |     INFO | core.Core | run_model_training 耗时: 0.00s
2025-07-29 00:21:54,213 |    ERROR | core.Core | 模型训练失败，终止流水线
2025-07-29 00:21:54,213 |     INFO | core.Core | run_full_pipeline 耗时: 1202.39s
