2025-07-28 16:43:39,296 |     INFO | core.Core | 初始化DataSegment: 8 个进程, chunk_size=200000
2025-07-28 16:43:39,296 |     INFO | core.Core | DataProcessor初始化: chunk_size=200000, n_processes=8
2025-07-28 16:43:39,297 |     INFO | core.Core | 预测器初始化: GPU=None
2025-07-28 16:43:39,299 |     INFO | core.Core | 航班排名系统核心控制器初始化完成
2025-07-28 16:43:39,299 |     INFO | core.Core | ================================================================================
2025-07-28 16:43:39,299 |     INFO | core.Core | 开始完整流水线执行
2025-07-28 16:43:39,299 |     INFO | core.Core | ================================================================================
2025-07-28 16:43:39,300 |     INFO | core.Core | ============================================================
2025-07-28 16:43:39,300 |     INFO | core.Core | 开始数据处理阶段
2025-07-28 16:43:39,300 |     INFO | core.Core | ============================================================
2025-07-28 16:43:39,300 |     INFO | core.Core | 开始数据处理流水线
2025-07-28 16:43:39,301 |     INFO | core.Core | 所有输出文件已存在
2025-07-28 16:43:39,301 |     INFO | core.Core | 执行完整性验证...
2025-07-28 16:43:39,301 |     INFO | core.Core | 开始验证分割结果...
2025-07-28 16:43:55,143 |     INFO | core.Core | 验证结果:
2025-07-28 16:43:55,152 |     INFO | core.Core |   原始数据: 18,145,372 行, 105,539 ranker_id
2025-07-28 16:43:55,152 |     INFO | core.Core |   分割数据: 18,145,372 行, 105,539 ranker_id
2025-07-28 16:43:55,152 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-28 16:43:56,046 |     INFO | core.Core | 现有分割文件验证通过
2025-07-28 16:43:56,060 |     INFO | core.Core | 开始验证分割结果...
2025-07-28 16:44:00,014 |     INFO | core.Core | 验证结果:
2025-07-28 16:44:00,014 |     INFO | core.Core |   原始数据: 6,897,776 行, 45,231 ranker_id
2025-07-28 16:44:00,015 |     INFO | core.Core |   分割数据: 6,897,776 行, 45,231 ranker_id
2025-07-28 16:44:00,015 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-28 16:44:00,081 |     INFO | core.Core | 现有分割文件验证通过
2025-07-28 16:44:00,081 |     INFO | core.Core | 验证通过，跳过处理
2025-07-28 16:44:00,082 |     INFO | core.Core | process_pipeline 耗时: 20.78s
2025-07-28 16:44:00,083 |     INFO | core.Core | ✓ 数据处理阶段完成
2025-07-28 16:44:00,083 |     INFO | core.Core | run_data_processing 耗时: 20.78s
2025-07-28 16:44:00,085 |     INFO | core.Core | ============================================================
2025-07-28 16:44:00,085 |     INFO | core.Core | 开始模型训练阶段
2025-07-28 16:44:00,085 |     INFO | core.Core | ============================================================
2025-07-28 16:44:00,086 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_0.parquet
2025-07-28 16:44:00,087 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_1.parquet
2025-07-28 16:44:00,087 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_2.parquet
2025-07-28 16:44:00,088 |     INFO | core.Core | 开始K-Fold训练所有段: [0, 1, 2]
2025-07-28 16:44:00,089 |     INFO | core.Core | 开始K-Fold训练 segment_0
2025-07-28 16:44:01,052 |     INFO | core.Core | 原始数据形状: (6126014, 126)
2025-07-28 16:44:05,230 |     INFO | core.Core | 剔除 74 个恒定值列: ['bySelf', 'legs0_segments1_aircraft_code', 'legs0_segments1_arrivalTo_airport_city_iata', 'legs0_segments1_arrivalTo_airport_iata', 'legs0_segments1_baggageAllowance_quantity', 'legs0_segments1_baggageAllowance_weightMeasurementType', 'legs0_segments1_cabinClass', 'legs0_segments1_departureFrom_airport_iata', 'legs0_segments1_duration', 'legs0_segments1_flightNumber', 'legs0_segments1_marketingCarrier_code', 'legs0_segments1_operatingCarrier_code', 'legs0_segments1_seatsAvailable', 'legs0_segments2_aircraft_code', 'legs0_segments2_arrivalTo_airport_city_iata', 'legs0_segments2_arrivalTo_airport_iata', 'legs0_segments2_baggageAllowance_quantity', 'legs0_segments2_baggageAllowance_weightMeasurementType', 'legs0_segments2_cabinClass', 'legs0_segments2_departureFrom_airport_iata', 'legs0_segments2_duration', 'legs0_segments2_flightNumber', 'legs0_segments2_marketingCarrier_code', 'legs0_segments2_operatingCarrier_code', 'legs0_segments2_seatsAvailable', 'legs0_segments3_aircraft_code', 'legs0_segments3_arrivalTo_airport_city_iata', 'legs0_segments3_arrivalTo_airport_iata', 'legs0_segments3_baggageAllowance_quantity', 'legs0_segments3_baggageAllowance_weightMeasurementType', 'legs0_segments3_cabinClass', 'legs0_segments3_departureFrom_airport_iata', 'legs0_segments3_duration', 'legs0_segments3_flightNumber', 'legs0_segments3_marketingCarrier_code', 'legs0_segments3_operatingCarrier_code', 'legs0_segments3_seatsAvailable', 'legs1_segments1_aircraft_code', 'legs1_segments1_arrivalTo_airport_city_iata', 'legs1_segments1_arrivalTo_airport_iata', 'legs1_segments1_baggageAllowance_quantity', 'legs1_segments1_baggageAllowance_weightMeasurementType', 'legs1_segments1_cabinClass', 'legs1_segments1_departureFrom_airport_iata', 'legs1_segments1_duration', 'legs1_segments1_flightNumber', 'legs1_segments1_marketingCarrier_code', 'legs1_segments1_operatingCarrier_code', 'legs1_segments1_seatsAvailable', 'legs1_segments2_aircraft_code', 'legs1_segments2_arrivalTo_airport_city_iata', 'legs1_segments2_arrivalTo_airport_iata', 'legs1_segments2_baggageAllowance_quantity', 'legs1_segments2_baggageAllowance_weightMeasurementType', 'legs1_segments2_cabinClass', 'legs1_segments2_departureFrom_airport_iata', 'legs1_segments2_duration', 'legs1_segments2_flightNumber', 'legs1_segments2_marketingCarrier_code', 'legs1_segments2_operatingCarrier_code', 'legs1_segments2_seatsAvailable', 'legs1_segments3_aircraft_code', 'legs1_segments3_arrivalTo_airport_city_iata', 'legs1_segments3_arrivalTo_airport_iata', 'legs1_segments3_baggageAllowance_quantity', 'legs1_segments3_baggageAllowance_weightMeasurementType', 'legs1_segments3_cabinClass', 'legs1_segments3_departureFrom_airport_iata', 'legs1_segments3_duration', 'legs1_segments3_flightNumber', 'legs1_segments3_marketingCarrier_code', 'legs1_segments3_operatingCarrier_code', 'legs1_segments3_seatsAvailable', 'pricingInfo_passengerCount']
2025-07-28 16:44:05,696 |     INFO | core.Core | 处理后数据形状: (6126014, 52)
2025-07-28 16:44:07,153 |     INFO | core.Core | 原始ranker数量: 27625
2025-07-28 16:44:07,590 |     INFO | core.Core | 过滤后ranker数量: 18560
2025-07-28 16:44:07,590 |     INFO | core.Core | 过滤后数据形状: (6089760, 52)
2025-07-28 16:44:07,642 |     INFO | core.Core | GPU模式: 禁用
2025-07-28 16:44:12,614 |     INFO | core.Core | 特征数量: 44
2025-07-28 16:44:17,329 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-28 16:44:18,584 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-28 16:44:19,847 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-28 16:44:21,016 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-28 16:44:22,232 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-28 16:44:22,240 |     INFO | core.Core | 开始自动调参...
2025-07-28 16:44:22,710 |     INFO | core.Core | 采样: 14848 -> 11878 rankers, 4871808 -> 3849386 samples
2025-07-28 16:44:22,723 |     INFO | core.Core | GPU模式: 禁用
