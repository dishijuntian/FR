2025-07-27 14:48:58,528 |     INFO | core.Core | 配置初始化: GPU=None, 优化={'enable_parallel': True, 'enable_cache': True, 'enable_memory_opt': True}
2025-07-27 14:48:58,529 |     INFO | core.Core | 初始化DataSegment: 8 个进程, chunk_size=200000
2025-07-27 14:48:58,530 |     INFO | core.Core | DataProcessor初始化: chunk_size=200000, n_processes=8
2025-07-27 14:48:58,531 |     INFO | core.Core | 训练器初始化: GPU=None, 配置={'n_estimators': 200, 'max_depth': 8, 'learning_rate': 0.05, 'random_state': 42}
2025-07-27 14:48:58,531 |     INFO | core.Core | 预测器初始化完成: GPU=None, 集成方法=weighted
2025-07-27 14:48:58,535 |     INFO | core.Core | 内存使用: 147.2MB (0.5%)
2025-07-27 14:48:58,536 |     INFO | core.Core | 启用并行段预测
2025-07-27 14:48:58,536 |     INFO | core.Core | 启用预测缓存
2025-07-27 14:48:58,536 |     INFO | core.Core | 航班排名系统核心控制器初始化完成
2025-07-27 14:48:58,538 |     INFO | core.Core | ================================================================================
2025-07-27 14:48:58,538 |     INFO | core.Core | 开始完整流水线执行
2025-07-27 14:48:58,539 |     INFO | core.Core | ================================================================================
2025-07-27 14:48:58,539 |     INFO | core.Core | ============================================================
2025-07-27 14:48:58,540 |     INFO | core.Core | 开始数据处理阶段
2025-07-27 14:48:58,540 |     INFO | core.Core | ============================================================
2025-07-27 14:48:58,541 |     INFO | core.Core | 开始数据处理流水线
2025-07-27 14:48:58,541 |     INFO | core.Core | 所有输出文件已存在
2025-07-27 14:48:58,542 |     INFO | core.Core | 执行完整性验证...
2025-07-27 14:48:58,542 |     INFO | core.Core | 开始验证分割结果...
2025-07-27 14:49:30,627 |     INFO | core.Core | 验证结果:
2025-07-27 14:49:30,634 |     INFO | core.Core |   原始数据: 18,145,372 行, 105,539 ranker_id
2025-07-27 14:49:30,635 |     INFO | core.Core |   分割数据: 18,145,372 行, 105,539 ranker_id
2025-07-27 14:49:30,636 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-27 14:49:32,124 |     INFO | core.Core | 现有分割文件验证通过
2025-07-27 14:49:32,128 |     INFO | core.Core | 开始验证分割结果...
2025-07-27 14:49:45,414 |     INFO | core.Core | 验证结果:
2025-07-27 14:49:45,416 |     INFO | core.Core |   原始数据: 6,897,776 行, 45,231 ranker_id
2025-07-27 14:49:45,417 |     INFO | core.Core |   分割数据: 6,897,776 行, 45,231 ranker_id
2025-07-27 14:49:45,418 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-27 14:49:45,736 |     INFO | core.Core | 现有分割文件验证通过
2025-07-27 14:49:45,737 |     INFO | core.Core | 验证通过，跳过处理
2025-07-27 14:49:45,739 |     INFO | core.Core | process_pipeline 耗时: 47.20s
2025-07-27 14:49:45,741 |     INFO | core.Core | ✓ 数据处理阶段完成
2025-07-27 14:49:45,742 |     INFO | core.Core | run_data_processing 耗时: 47.20s
2025-07-27 14:49:45,744 |     INFO | core.Core | ============================================================
2025-07-27 14:49:45,745 |     INFO | core.Core | 开始模型训练阶段
2025-07-27 14:49:45,746 |     INFO | core.Core | ============================================================
2025-07-27 14:49:45,754 |     INFO | core.Core | 开始训练 segment_0
2025-07-27 14:49:50,880 |     INFO | core.Core | GPU自动检测: XGB=True, LGB=True
2025-07-27 14:49:50,881 |     INFO | core.Core | ✓ GPU模式已启用
2025-07-27 14:51:00,524 |     INFO | core.Core | prepare_data 内存变化: +4054.7MB (当前: 15702.4MB)
2025-07-27 14:51:00,526 |     INFO | core.Core | prepare_data 耗时: 69.64s
2025-07-27 14:51:13,222 |     INFO | core.Core | Segment 0: (6126014, 126) -> 117特征, 27625个ranker, 27折CV
2025-07-27 14:51:13,224 |     INFO | core.Core | _prepare_cv_data 内存变化: +4216.8MB (当前: 15702.4MB)
2025-07-27 14:51:13,235 |     INFO | core.Core | _prepare_cv_data 耗时: 84.52s
2025-07-27 17:33:04,043 |     INFO | core.Core | GPU自动检测: XGB=True, LGB=True
2025-07-27 17:33:04,044 |     INFO | core.Core | ✓ GPU模式已启用
2025-07-27 18:57:23,812 |  WARNING | core.Core | XGBRanker GPU训练失败，尝试CPU: [18:57:23] C:\buildkite-agent\builds\buildkite-windows-cpu-autoscaling-group-i-0fdc6d574b9c0d168-1\xgboost\xgboost-ci-windows\src\data\data.cc:689: Check failed: group_ptr_.back() == num_row_ (5871214 vs. 5871565) : Invalid group structure.  Number of rows obtained from groups doesn't equal to actual number of rows given by data.
2025-07-27 19:48:51,555 |     INFO | core.Core | XGBRanker (CPU回退) HitRate@3: 0.4551
2025-07-27 20:27:56,412 |     INFO | core.Core | LGBMRanker HitRate@3: 0.4551
2025-07-27 20:27:56,430 |     INFO | core.Core | train_models 内存变化: -773.4MB (当前: 5045.6MB)
2025-07-27 20:27:56,430 |     INFO | core.Core | train_models 耗时: 10492.38s
2025-07-27 20:27:56,431 |     INFO | core.Core | Fold 1 - XGBRanker: 0.4551
2025-07-27 20:27:56,431 |     INFO | core.Core | Fold 1 - LGBMRanker: 0.4551
2025-07-27 20:27:56,611 |     INFO | core.Core | _train_fold 耗时: 20203.36s
2025-07-27 21:05:06,896 |     INFO | core.Core | GPU自动检测: XGB=True, LGB=True
2025-07-27 21:05:06,897 |     INFO | core.Core | ✓ GPU模式已启用
2025-07-27 21:43:01,943 |     INFO | core.Core | XGBRanker HitRate@3: 0.4531
2025-07-27 22:26:51,388 |     INFO | core.Core | LGBMRanker HitRate@3: 0.4365
2025-07-27 22:26:51,559 |     INFO | core.Core | train_models 内存变化: -2769.1MB (当前: 2984.5MB)
2025-07-27 22:26:51,561 |     INFO | core.Core | train_models 耗时: 4904.66s
2025-07-27 22:26:51,562 |     INFO | core.Core | Fold 2 - XGBRanker: 0.4531
2025-07-27 22:26:51,563 |     INFO | core.Core | Fold 2 - LGBMRanker: 0.4365
2025-07-27 22:26:52,095 |     INFO | core.Core | _train_fold 耗时: 7135.48s
2025-07-28 01:04:22,194 |     INFO | core.Core | GPU自动检测: XGB=True, LGB=True
2025-07-28 01:04:22,196 |     INFO | core.Core | ✓ GPU模式已启用
2025-07-28 03:42:08,486 |     INFO | core.Core | XGBRanker HitRate@3: 0.4746
2025-07-28 06:25:27,626 |     INFO | core.Core | LGBMRanker HitRate@3: 0.4521
2025-07-28 06:25:27,805 |     INFO | core.Core | train_models 内存变化: -2760.4MB (当前: 3023.4MB)
2025-07-28 06:25:27,806 |     INFO | core.Core | train_models 耗时: 19265.61s
2025-07-28 06:25:27,807 |     INFO | core.Core | Fold 3 - XGBRanker: 0.4746
2025-07-28 06:25:27,808 |     INFO | core.Core | Fold 3 - LGBMRanker: 0.4521
2025-07-28 06:25:28,226 |     INFO | core.Core | _train_fold 耗时: 28716.13s
2025-07-28 09:03:37,400 |     INFO | core.Core | GPU自动检测: XGB=True, LGB=True
2025-07-28 09:03:37,413 |     INFO | core.Core | ✓ GPU模式已启用
2025-07-28 11:25:29,899 |     INFO | core.Core | XGBRanker HitRate@3: 0.4482
2025-07-28 12:48:27,230 |     INFO | core.Core | LGBMRanker HitRate@3: 0.4395
2025-07-28 12:48:27,593 |     INFO | core.Core | train_models 内存变化: -2819.6MB (当前: 2949.8MB)
2025-07-28 12:48:27,594 |     INFO | core.Core | train_models 耗时: 13490.18s
2025-07-28 12:48:27,595 |     INFO | core.Core | Fold 4 - XGBRanker: 0.4482
2025-07-28 12:48:27,596 |     INFO | core.Core | Fold 4 - LGBMRanker: 0.4395
2025-07-28 12:48:28,059 |     INFO | core.Core | _train_fold 耗时: 22979.83s
