2025-07-29 08:14:19,744 |     INFO | core.Core | 初始化DataSegment: 8 个进程, chunk_size=200000
2025-07-29 08:14:19,744 |     INFO | core.Core | DataProcessor初始化: chunk_size=200000, n_processes=8
2025-07-29 08:14:19,745 |     INFO | core.Core | 预测器初始化: GPU=None
2025-07-29 08:14:19,745 |     INFO | core.Core | 航班排名系统核心控制器初始化完成
2025-07-29 08:14:19,745 |     INFO | core.Core | ================================================================================
2025-07-29 08:14:19,745 |     INFO | core.Core | 开始完整流水线执行
2025-07-29 08:14:19,745 |     INFO | core.Core | ================================================================================
2025-07-29 08:14:19,746 |     INFO | core.Core | ============================================================
2025-07-29 08:14:19,746 |     INFO | core.Core | 开始数据处理阶段
2025-07-29 08:14:19,746 |     INFO | core.Core | ============================================================
2025-07-29 08:14:19,746 |     INFO | core.Core | 开始数据处理流水线
2025-07-29 08:14:19,746 |     INFO | core.Core | 所有输出文件已存在
2025-07-29 08:14:19,746 |     INFO | core.Core | 执行完整性验证...
2025-07-29 08:14:19,746 |     INFO | core.Core | 开始验证分割结果...
2025-07-29 08:14:29,074 |     INFO | core.Core | 验证结果:
2025-07-29 08:14:29,074 |     INFO | core.Core |   原始数据: 18,145,372 行, 105,539 ranker_id
2025-07-29 08:14:29,075 |     INFO | core.Core |   分割数据: 18,075,751 行, 90,728 ranker_id
2025-07-29 08:14:29,075 |     INFO | core.Core |   行数匹配: False, ranker_id匹配: False
2025-07-29 08:14:29,075 |  WARNING | core.Core | 行数差异: 69621 行
2025-07-29 08:14:29,075 |  WARNING | core.Core | ranker_id差异: 14811 个
2025-07-29 08:14:29,419 |  WARNING | core.Core | 略过 Train 数据集完整性验证
2025-07-29 08:14:29,419 |     INFO | core.Core | 开始验证分割结果...
2025-07-29 08:14:31,925 |     INFO | core.Core | 验证结果:
2025-07-29 08:14:31,925 |     INFO | core.Core |   原始数据: 6,897,776 行, 45,231 ranker_id
2025-07-29 08:14:31,927 |     INFO | core.Core |   分割数据: 6,897,776 行, 45,231 ranker_id
2025-07-29 08:14:31,927 |     INFO | core.Core |   行数匹配: True, ranker_id匹配: True
2025-07-29 08:14:31,972 |     INFO | core.Core | 现有分割文件验证通过
2025-07-29 08:14:31,973 |     INFO | core.Core | 验证通过，跳过处理
2025-07-29 08:14:31,973 |     INFO | core.Core | process_pipeline 耗时: 12.23s
2025-07-29 08:14:31,973 |     INFO | core.Core | ✓ 数据处理阶段完成
2025-07-29 08:14:31,973 |     INFO | core.Core | run_data_processing 耗时: 12.23s
2025-07-29 08:14:31,974 |     INFO | core.Core | ============================================================
2025-07-29 08:14:31,974 |     INFO | core.Core | 开始模型训练阶段
2025-07-29 08:14:31,974 |     INFO | core.Core | ============================================================
2025-07-29 08:14:31,974 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_0.parquet
2025-07-29 08:14:31,975 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_1.parquet
2025-07-29 08:14:31,975 |     INFO | core.Core | ✓ 训练数据文件存在: train_segment_2.parquet
2025-07-29 08:14:31,975 |     INFO | core.Core | 开始K-Fold训练所有段: [0, 1, 2]
2025-07-29 08:14:31,975 |     INFO | core.Core | 开始K-Fold训练 segment_0
2025-07-29 08:14:32,433 |     INFO | core.Core | 原始数据形状: (6089760, 52)
2025-07-29 08:14:33,441 |     INFO | core.Core | 原始ranker数量: 18560
2025-07-29 08:14:33,782 |     INFO | core.Core | 过滤后ranker数量: 18560
2025-07-29 08:14:33,783 |     INFO | core.Core | 过滤后数据形状: (6089760, 52)
2025-07-29 08:14:33,886 |  WARNING | core.Core | XGBoost GPU测试失败: group or qid is required for ranking task
2025-07-29 08:14:33,887 |  WARNING | core.Core | LightGBM GPU测试失败: Should set group for ranking task
2025-07-29 08:14:33,887 |  WARNING | core.Core | XGBoost将使用CPU
2025-07-29 08:14:33,887 |  WARNING | core.Core | LightGBM将使用CPU
2025-07-29 08:14:33,888 |     INFO | core.Core | GPU模式: 禁用
2025-07-29 08:14:38,260 |     INFO | core.Core | 特征数量: 44
2025-07-29 08:14:42,326 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-29 08:14:43,365 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-29 08:14:44,396 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-29 08:14:45,442 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-29 08:14:46,457 |     INFO | core.Core | Fold - 训练ranker数: 14848, 验证ranker数: 3712
2025-07-29 08:14:46,463 |     INFO | core.Core | 开始自动调参...
2025-07-29 08:14:46,904 |     INFO | core.Core | 采样: 14848 -> 11878 rankers, 4871808 -> 3914606 samples
2025-07-29 08:14:46,917 |  WARNING | core.Core | XGBoost GPU测试失败: group or qid is required for ranking task
2025-07-29 08:14:46,918 |  WARNING | core.Core | LightGBM GPU测试失败: Should set group for ranking task
2025-07-29 08:14:46,918 |  WARNING | core.Core | XGBoost将使用CPU
2025-07-29 08:14:46,919 |  WARNING | core.Core | LightGBM将使用CPU
2025-07-29 08:14:46,919 |     INFO | core.Core | GPU模式: 禁用
2025-07-29 08:23:55,603 |     INFO | core.Core | 训练 XGBRanker...
2025-07-29 08:24:51,147 |     INFO | core.Core | ✓ XGBRanker 训练完成
2025-07-29 08:24:51,148 |     INFO | core.Core | 训练 LGBMRanker...
2025-07-29 08:25:26,552 |     INFO | core.Core | ✓ LGBMRanker 训练完成
2025-07-29 08:25:26,558 |    ERROR | core.Core | ✗ segment_0 训练失败: 'FlightRankingModels' object has no attribute 'predict'
2025-07-29 08:25:26,558 |     INFO | core.Core | 开始K-Fold训练 segment_1
2025-07-29 08:25:27,725 |     INFO | core.Core | 原始数据形状: (10865187, 76)
2025-07-29 08:25:29,828 |     INFO | core.Core | 原始ranker数量: 66586
2025-07-29 08:25:30,374 |     INFO | core.Core | 过滤后ranker数量: 66586
2025-07-29 08:25:30,375 |     INFO | core.Core | 过滤后数据形状: (10865187, 76)
2025-07-29 08:25:30,417 |  WARNING | core.Core | XGBoost GPU测试失败: group or qid is required for ranking task
2025-07-29 08:25:30,417 |  WARNING | core.Core | LightGBM GPU测试失败: Should set group for ranking task
2025-07-29 08:25:30,418 |  WARNING | core.Core | XGBoost将使用CPU
2025-07-29 08:25:30,418 |  WARNING | core.Core | LightGBM将使用CPU
2025-07-29 08:25:30,418 |     INFO | core.Core | GPU模式: 禁用
2025-07-29 08:26:03,061 |     INFO | core.Core | 特征数量: 68
2025-07-29 08:26:47,826 |     INFO | core.Core | Fold - 训练ranker数: 53269, 验证ranker数: 13317
2025-07-29 08:27:05,102 |     INFO | core.Core | Fold - 训练ranker数: 53269, 验证ranker数: 13317
2025-07-29 08:27:22,622 |     INFO | core.Core | Fold - 训练ranker数: 53268, 验证ranker数: 13318
2025-07-29 08:27:40,051 |     INFO | core.Core | Fold - 训练ranker数: 53269, 验证ranker数: 13317
2025-07-29 08:27:57,630 |     INFO | core.Core | Fold - 训练ranker数: 53269, 验证ranker数: 13317
2025-07-29 08:27:57,679 |     INFO | core.Core | 开始自动调参...
2025-07-29 08:28:01,094 |     INFO | core.Core | 采样: 53269 -> 42615 rankers, 8692151 -> 6945958 samples
2025-07-29 08:28:01,254 |  WARNING | core.Core | XGBoost GPU测试失败: group or qid is required for ranking task
2025-07-29 08:28:01,256 |  WARNING | core.Core | LightGBM GPU测试失败: Should set group for ranking task
2025-07-29 08:28:01,258 |  WARNING | core.Core | XGBoost将使用CPU
2025-07-29 08:28:01,259 |  WARNING | core.Core | LightGBM将使用CPU
2025-07-29 08:28:01,260 |     INFO | core.Core | GPU模式: 禁用
